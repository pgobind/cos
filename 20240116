WITH RankedData AS (
    SELECT 
        T.*,
        COUNT(*) OVER (PARTITION BY colm1, colm2) as group_count,
        ROW_NUMBER() OVER (PARTITION BY colm1, colm2 ORDER BY sort_column) as row_within_group,
        MIN(ROW_NUMBER()) OVER (PARTITION BY colm1, colm2 ORDER BY sort_column) as group_start_row
    FROM 
        T
    -- Include WHERE conditions here if necessary
),
PaginatedData AS (
    SELECT *,
           ROW_NUMBER() OVER (ORDER BY colm1, colm2, sort_column) as overall_row_num
    FROM RankedData
)
SELECT *
FROM PaginatedData
WHERE overall_row_num > :offset AND overall_row_num <= :offset + :pageSize
AND group_start_row <= :offset;
