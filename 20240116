WITH GroupBoundaries AS (
    SELECT 
        T.*,
        ROW_NUMBER() OVER (ORDER BY known_sort_column_1, known_sort_column_2, ...) AS rn,
        COUNT(*) OVER (PARTITION BY colm1, colm2, colm3, colm4, colm5) AS group_size,
        FIRST_VALUE(rn) OVER (PARTITION BY colm1, colm2, colm3, colm4, colm5 ORDER BY known_sort_column_1, known_sort_column_2, ...) AS group_start,
        LAST_VALUE(rn) OVER (PARTITION BY colm1, colm2, colm3, colm4, colm5 ORDER BY known_sort_column_1, known_sort_column_2, ...) RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING AS group_end
    FROM 
        T
    WHERE
        -- Your complex WHERE conditions here
),
FilteredData AS (
    SELECT *,
           CASE 
               WHEN rn >= :startRow AND rn <= :endRow THEN 'Include'
               WHEN group_start <= :endRow AND group_end > :endRow THEN 'Include'
               ELSE 'Exclude'
           END AS inclusion_flag
    FROM GroupBoundaries
)
SELECT *
FROM FilteredData
WHERE inclusion_flag = 'Include'
ORDER BY known_sort_column_1, known_sort_column_2, ...;
